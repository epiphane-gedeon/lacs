{% extends "base.html" %}

{%block content%}
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <div class="form-container">
        <form method="POST">
            {{ form.hidden_tag() }}
            
            <div class="mb-4">
                <label for="title" class="block font-semibold">Titre</label>
                {{ form.titre(class="border border-gray-300 rounded p-2 w-full", id="title") }}
                {% if form.titre.errors %}
                    <div class="text-red-500">
                        {% for error in form.titre.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div class="mb-4">
                <label for="categorie" class="block font-semibold">Catégorie</label>
                {{ form.categorie_id(class="border border-gray-300 rounded p-2 w-full") }}
                {% if form.categorie_id.errors %}
                    <div class="text-red-500">
                        {% for error in form.categorie_id.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div class="mb-4">
                <label for="editor" class="block font-semibold">Contenu</label>
                <div id="editor" class="border border-gray-300 rounded p-2 bg-white" style="max-height: 150px;"></div>
                {{ form.contenu(style="") }}
                {% if form.contenu.errors %}
                    <div class="text-red-500">
                        {% for error in form.contenu.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div class="mb-4">
                <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
                    Publier l'article
                </button>
            </div>
        </form>
    </div>

    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <script>
    const quill = new Quill('#editor', {
        theme: 'snow',
        placeholder: 'Écris ton article ici...',
        modules: {
        toolbar: [['bold', 'italic'],[{ 'list': 'ordered'}], [{ 'list': 'check'}], ['clean'], ['link'], ['image'], ['code-block'], ['blockquote'],['video'],['formula'],[{ 'header': [1, 2, 3, false] }]],
        }
    });

    // Synchroniser le contenu de Quill avec le champ caché
    const form = document.querySelector('form');
    form.addEventListener('submit', function(e) {
        const contenuField = document.querySelector('textarea[name="contenu"]');
        contenuField.value = quill.root.innerHTML;
    });
    </script>

    <style>
        .form-container {
            padding: 30px;
        }
        
        .mb-4 {
            margin-bottom: 1rem;
        }
        
        .block {
            display: block;
        }

        .ql-toolbar.ql-snow {
        border-radius: 0.375rem; /* Tailwind's rounded-md */
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
        border: 1px solid #146C53;
        background-color: #fff;
        }

        .ql-container.ql-snow {
        border-top-left-radius: 0;
        border-top-right-radius: 0;
        border: 1px solid #146C53;
        }

        .ql-editor {
        padding: 0.5rem;
        max-height: 150px;
        }
        
        .font-semibold {
            font-weight: 600;
        }
        
        .border {
            border-width: 1px;
            border-style: solid;
            border-color: #146C53;
        }
        
        .rounded {
            border-radius: 0.375rem; /* Tailwind's rounded-md */
        }
        
        .p-2 {
            padding: 0.5rem; /* Tailwind's p-2 */
        }
        
        .w-full {
            width: 100%;
        }
        .bg-white {
            background-color: #fff;
        }
        
        .bg-green-600 {
            background-color: #16a34a;
        }
        
        .bg-green-600:hover, .hover\\:bg-green-700:hover {
            background-color: #15803d;
        }
        
        .text-white {
            color: #fff;
        }
        
        .text-red-500 {
            color: #ef4444;
        }
        
        .px-4 {
            padding-left: 1rem;
            padding-right: 1rem;
        }
        
        .py-2 {
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
        }
        
        button {
            cursor: pointer;
        }
    </style>
{% endblock %}